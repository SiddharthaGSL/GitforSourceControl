function "main"."int$pkg_glimport_int$pkg_glimport_validate_atx(bigint, bigint, timestamp without time zone, bigint)" {
  text = """

DECLARE

      v_status   char(1);
      errmsg     varchar(200);
      errcode    bigint;
BEGIN
      -- glcode length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Glcode length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(glcode::text) > 12
                AND glcode IS NOT NULL
                AND userid = p_userid;

      -- glname length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Gl Name length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(glname) > 100
                AND glname IS NOT NULL
                AND userid = p_userid;

      -- abbre length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Abbre length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(abbre) > 100
                AND abbre IS NOT NULL
                AND userid = p_userid;

      -- chart of accounts length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Chart Of Accounts length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(chartofaccounts) > 100
                AND chartofaccounts IS NOT NULL
                AND userid = p_userid;

      -- address length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Address length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(addr) > 500
                AND addr IS NOT NULL
                AND userid = p_userid;

      -- city length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'City length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(ctname) > 100
                AND ctname IS NOT NULL
                AND userid = p_userid;

      -- pin length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Pin length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE LENGTH(pin::text) > 12 AND pin IS NOT NULL AND userid = p_userid;

      -- ph1 length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Phone 1 length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE LENGTH(ph1) > 12 AND ph1 IS NOT NULL AND userid = p_userid;

      -- ph2 length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Phone 2 length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE LENGTH(ph2) > 12 AND ph2 IS NOT NULL AND userid = p_userid;

      -- ph3 length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Phone 3 length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE LENGTH(ph3) > 12 AND ph3 IS NOT NULL AND userid = p_userid;

      -- ph4 length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Phone 4 length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE LENGTH(ph4) > 12 AND ph4 IS NOT NULL AND userid = p_userid;

      -- fax1 length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Fax 1 length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE LENGTH(fx1) > 12 AND fx1 IS NOT NULL AND userid = p_userid;

      -- fax2 length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Fax 2 length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE LENGTH(fx2) > 12 AND fx2 IS NOT NULL AND userid = p_userid;

      -- email length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Email length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(email) > 100
                AND email IS NOT NULL
                AND userid = p_userid;

      -- website length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Website length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(website) > 100
                AND website IS NOT NULL
                AND userid = p_userid;

      -- cp length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Contact Person length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE LENGTH(cp) > 100 AND cp IS NOT NULL AND userid = p_userid;

      -- LST no length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'LST No length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(lstno) > 100
                AND lstno IS NOT NULL
                AND userid = p_userid;

      -- CST no length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'CST No length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(cstno) > 100
                AND cstno IS NOT NULL
                AND userid = p_userid;

      -- PAN no length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'PAN No length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE LENGTH(pan) > 100 AND pan IS NOT NULL AND userid = p_userid;

      -- intrate length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Interest Rate length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(intrate::text) > 23
                AND intrate IS NOT NULL
                AND userid = p_userid;

      -- source type length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Source Type length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(sourcetype) > 7
                AND sourcetype IS NOT NULL
                AND userid = p_userid;

      -- site applicable length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Site Applicable length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(siteapplicable) > 3
                AND siteapplicable IS NOT NULL
                AND userid = p_userid;

      -- ext length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Extinct length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE LENGTH(ext) > 3 AND ext IS NOT NULL AND userid = p_userid;

      -- cheque label length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Cheque Label length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(chqlabel) > 100
                AND chqlabel IS NOT NULL
                AND userid = p_userid;

      -- sub-Ledger Applicable length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Sub-Ledger Applicable length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(sl_applicable) > 3
                AND sl_applicable IS NOT NULL
                AND userid = p_userid;

      -- owner site length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Owner Site length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(cash_bank_owner_site::text) > 12
                AND cash_bank_owner_site IS NOT NULL
                AND userid = p_userid;

      -- glseq length
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Length Validation',
                'Ledger Sequence length is higher than it''s defined data length.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(glseq::text) > 5
                AND glseq IS NOT NULL
                AND userid = p_userid;

      -- glname is blank
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Mandatory Validation',
                'Gl Name is Mandatory.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE glname IS NULL AND userid = p_userid;

      -- chart of accounts is blank
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Mandatory Validation',
                'Chart Of Accounts is Mandatory.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE chartofaccounts IS NULL AND userid = p_userid;

      -- source type is blank
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Mandatory Validation',
                'Source Type is Mandatory.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE sourcetype IS NULL AND userid = p_userid;

      -- site applicable is blank
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Mandatory Validation',
                'Site Applicable is Mandatory.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE siteapplicable IS NULL AND userid = p_userid;

      -- glcode not exists
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Validation',
                'Invalid GlCode.',
                clock_timestamp()
           FROM int$stg_glimport s
LEFT OUTER JOIN fingl gl ON (s.glcode = gl.glcode)
WHERE gl.glcode IS NULL AND s.glcode IS NOT NULL AND s.userid = p_userid;

      -- duplicate glname
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Validation',
                'Duplicate GL Name.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     s.userid = p_userid
                AND UPPER(s.glname) IN (SELECT UPPER(tmp.glname)
                          FROM (SELECT UPPER(s1.glname) glname,
                                       ROW_NUMBER()
                                       OVER (PARTITION BY UPPER(s1.glname)
                                             ORDER BY UPPER(s1.glname))
                                          cnt_glname
                                  FROM int$stg_glimport s1
                                 WHERE s1.userid = p_userid) tmp
                         WHERE cnt_glname > 1);

      -- chart of accounts not exists for new gl
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Validation',
                'Invalid GRP Name.',
                clock_timestamp()
           FROM int$stg_glimport s
LEFT OUTER JOIN (SELECT UPPER(glname) glname FROM fingl) gl ON (UPPER(s.glname) = gl.glname)
LEFT OUTER JOIN (SELECT UPPER(grpname) grpname, grpcode
                   FROM fingrp grp) f_grp ON (UPPER(s.chartofaccounts) = f_grp.grpname)
WHERE s.userid = p_userid   AND s.chartofaccounts IS NOT NULL AND f_grp.grpname IS NULL AND s.glname IS NOT NULL AND gl.glname IS NULL;

      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                0,
                'GLIMPORT',
                p_userid,
                'Data Validation',
                'Invalid GRP Name.',
                clock_timestamp()
           FROM (  SELECT grp.grpname, COUNT(DISTINCT grp.grpname) cnt_grpname
                     FROM int$stg_glimport s,
                          (SELECT UPPER(grpname) grpname FROM fingrp) grp
                    WHERE     s.userid = p_userid
                          AND UPPER(s.chartofaccounts) = grp.grpname
                          AND s.glname IS NOT NULL
                          AND s.glcode IS NULL
                          AND s.chartofaccounts IS NOT NULL
                 GROUP BY grp.grpname) tmp
          WHERE cnt_grpname > 1;

      -- city name not exists
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Validation',
                'Invalid City.',
                clock_timestamp()
           FROM int$stg_glimport s
LEFT OUTER JOIN (SELECT UPPER(ctname) ctname
                   FROM admcity
                  WHERE ext = 'N') ct ON (s.ctname = ct.ctname)
WHERE ct.ctname IS NULL AND s.ctname IS NOT NULL AND s.userid = p_userid;

      -- invalid pin
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Validation',
                'Invalid Pin.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(s.pin) > 6
                AND s.pin IS NOT NULL
                AND s.userid = p_userid;

      -- invalid email
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Validation',
                'Invalid Email Id.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE (position('@' in s.email) = 0 OR position('.' in s.email) = 0)
                AND s.email IS NOT NULL
                AND s.userid = p_userid;

      -- invalid website
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Validation',
                'Invalid Website.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     position('.' in s.website) = 0
                AND s.website IS NOT NULL
                AND s.userid = p_userid;

      -- invalid pan
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Validation',
                'Invalid PAN No.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(s.pan) <> 10
                AND s.pan IS NOT NULL
                AND s.userid = p_userid;

      -- invalid interest rate
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Validation',
                'Invalid Interest Rate.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(
                       RTRIM(
                          LTRIM(TRANSLATE(s.intrate, '1234567890.', '')))::text) >
                       0
                AND s.intrate IS NOT NULL
                AND s.userid = p_userid;

      -- invalid source type
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Validation',
                'Invalid Source Type.',
                clock_timestamp()
           FROM int$stg_glimport a, fingrp grp
          WHERE     UPPER(a.chartofaccounts) = UPPER(grp.grpname)
                AND (grp.TYPE IN ('I', 'E')
                       AND UPPER(a.sourcetype) <> 'GENERAL')
                AND a.userid = p_userid;

      -- invalid site appl
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Validation',
                'Invalid Site Applicable.',
                clock_timestamp()
           FROM int$stg_glimport a, fingrp grp
          WHERE     UPPER(a.chartofaccounts) = UPPER(grp.grpname)
                AND (   (    grp.TYPE IN ('I', 'E')
                         AND UPPER(a.sourcetype) = 'GENERAL'
                         AND UPPER(siteapplicable) <> 'YES')
                     OR (    grp.TYPE IN ('L',
                                          'A',
                                          'I',
                                          'E')
                         AND UPPER(a.sourcetype) IN ('CASH', 'AR/AP', 'BANK')
                         AND UPPER(siteapplicable) <> 'NO'))
                AND a.userid = p_userid;

      -- invalid extinct
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Validation',
                'Invalid Extinct Value.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     UPPER(ext) NOT IN ('YES', 'NO')
                AND s.ext IS NOT NULL
                AND s.userid = p_userid;

      -- invalid SL appl
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Validation',
                'Invalid SL Applicable**.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     (   (    UPPER(s.sourcetype) = 'AR/AP'
                         AND UPPER(s.sl_applicable) <> 'YES')
                     OR (    UPPER(s.sourcetype) = 'GENERAL'
                         AND UPPER(s.sl_applicable) NOT IN ('YES', 'NO'))
                     OR (    UPPER(s.sourcetype) NOT IN ('AR/AP', 'GENERAL')
                         AND UPPER(s.sl_applicable) <> 'NO'))
                AND s.sl_applicable IS NOT NULL
                AND s.userid = p_userid;

      -- invalid cash_bank_owner_site
      -- case I
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Validation',
                'Owner site is not applicable.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     UPPER(sourcetype) NOT IN ('CASH', 'BANK')
                AND s.cash_bank_owner_site IS NOT NULL
                AND s.userid = p_userid;

      -- case II
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Validation',
                'Invalid Owner site.',
                clock_timestamp()
           FROM int$stg_glimport s
LEFT OUTER JOIN admsite st ON (s.cash_bank_owner_site = st.code)
WHERE   -- START REV : 003
                                                    -- START REV : 002
                                                    --and     s.cash_bank_owner_site is not null
   s.cash_bank_owner_site IS NOT NULL  -- END REV : 003
  AND st.code IS NULL  -- END REV : 002
  AND s.userid = p_userid;

      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Validation',
                'Invalid Owner site.',
                clock_timestamp()
           FROM int$stg_glimport s
LEFT OUTER JOIN admsite st ON (s.cash_bank_owner_site = st.code)
WHERE st.sitetype NOT IN ('OS-OO-CM', 'MS-OO-CM') AND UPPER(sourcetype) IN ('CASH', 'BANK') AND s.cash_bank_owner_site IS NOT NULL AND s.userid = p_userid;

      -- invalid glseq
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Validation',
                'Invalid GL Seq.',
                clock_timestamp()
           FROM int$stg_glimport s
          WHERE     LENGTH(
                       RTRIM(LTRIM(TRANSLATE(s.glseq, '1234567890', '')))::text) >
                       0
                AND s.glseq IS NOT NULL
                AND s.userid = p_userid;

      -- glname already exists in fingl table
      INSERT INTO int$error_log(code,
                                 lineno,
                                 classname,
                                 userid,
                                 errortype,
                                 errordesc,
                                 createdon)
         SELECT nextval('int$error_log_code'),
                lineno,
                'GLIMPORT',
                userid,
                'Data Validation',
                'GL already exists.',
                clock_timestamp()
           FROM int$stg_glimport s, fingl gl
          WHERE     UPPER(s.glname) = UPPER(gl.glname)
                AND s.glname IS NOT NULL
                AND s.glcode IS NULL
                AND s.userid = p_userid;

      -- check whether records are valid or not
      BEGIN
         SELECT 'S'
           INTO STRICT v_status
           
          WHERE EXISTS (SELECT 'S'
                      FROM int$error_log
                     WHERE userid = p_userid);

         RETURN('0');
      EXCEPTION
         WHEN no_data_found
         THEN
            RETURN('1');
      END;
   EXCEPTION
      WHEN OTHERS
      THEN
         errcode := SQLSTATE;
         errmsg := SQLERRM;

         INSERT INTO int$error_log(code,
                                    lineno,
                                    classname,
                                    userid,
                                    errortype,
                                    errordesc,
                                    createdon)
              VALUES (nextval('int$error_log_code'),
                      0,
                      'GLIMPORT',
                      p_userid,
                      errcode,
                      errmsg,
                      clock_timestamp());

         --COMMIT;

         RETURN('0');
   END;

"""
  returnType = character
  arguments = <
    {
      name = p_userid
      type = bigint
      mode = IN
    }

    {
      name = p_connect_site
      type = bigint
      mode = IN
    }

    {
      name = p_logging_date
      type = timestamp without time zone
      mode = IN
    }

    {
      name = p_connect_ou
      type = bigint
      mode = IN
    }

  >
  language = plpgsql
}

